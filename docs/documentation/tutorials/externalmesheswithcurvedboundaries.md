# External Meshes with Curved Boundaries
This tutorial shows how several methods can be applied to curve the boundary faces of the elements.

The parameter file can be found in

    tutorials/2-02-external_mesh_CGNS_sphere_curved/parameter.ini

## Mesh Curving Techniques
In the development of next generation numerical methods for CFD, high-order methods are promising a substantial increase in efficiency and accuracy. While the particular high-order methods can be very distinct, they have in common that they must rely on a high-order approximation of curved geometries to maintain their high-order of accuracy. The generation of curved meshes is thus a topic the importance of which cannot be overstated, if one truly wants to apply high order methods to problems with industrial relevance. Especially aerospace applications heavily rely on complex geometries and pose high requirements to the quality of geometry representation.

<figure class="align-center" id="fig-curving">
    <a class="reference internal image-reference" href="../Curving.jpg"><img alt="../Curving.jpg" src="../Curving.jpg" style="width: 50%;" /></a>
    <figcaption>
    <p><span class="caption-number">Fig. 2.1 </span><span class="caption-text">From linear meshes to high order meshes.</span><a class="headerlink" href="#fig-curving" title="Permalink to this image"></a></p>
    </figcaption>
</figure>

HOPR provides several strategies to produce high-order meshes, relying on linear meshes, which are the standard of today's state-of-the-art meshing software and can be generated by commercial mesh generation tools. The two main strategies can be selected with the parameter `curvingMethod`. Therefore, the parameter `useCurveds` has to set to `T`.
```{table} Mesh Curving Techniques Parameter.
---
name: tab:Mesh Curving Techniques Parameter
---
  | Parameters      |Setting      | Description |
  | :------         | :----------:| :---------------------------     |
  | `curvingMethod` | `1`         |  	0: No curving method activated.<br>1: Curving with normal vectors at surface points.<br>3: Curving with subdivided surface mesh.  |
```

## Curving Using Normal Vectors
Using normal vectors at the surface points, one can reconstruct the curved boundary face. Normal vectors can either be reconstructed from the existing coarse mesh, given in a point-normal file or prescribed analytically. The way of providing the normal vectors can be selected with the parameter `NormalsType`. For each setting, a different number of new but self-explanatory parameters are mandatory. These parameters are listed below.

It has to be taken into account that for generating the curved boundary splines, the parameter `boundaryOrder` has to be always set to 4 for a normal vector approach. Otherwise HOPR will maybe not work correctly.

<figure class="align-center" id="fig-normalvectors">
    <a class="reference internal image-reference" href="../Normalvectors.jpg"><img alt="../Normalvectors.jpg" src="../Normalvectors.jpg" style="width: 90%;" /></a>
    <figcaption>
    <p><span class="caption-number">Fig. 2.2 </span><span class="caption-text">Sequence of constructing curved element edges from surface normals..</span><a class="headerlink" href="#fig-normalvectors" title="Permalink to this image"></a></p>
    </figcaption>
</figure>

<h4>Description of Parameters<a class="headerlink" href="#description-of-parameters" title="Permalink to this heading"></a></h4>

Below, all parameters which are mandatory for this curving technique are explained. A description of all parameters can be found in {ref}`userguide/parameters:List of Parameters`.

```{table} Curving Using Normal Vectors: Description of Parameters.
---
name: tab:Curving Using Normal Vectors Description of Parameters
---
  | Parameters      |Setting                | Description |
  | :------         | :----------:          | :---------------------------     |
  | `NormalsType`      | `1`     |  Source of the normal:<br>1: Reconstructed from coarse surface mesh (no additional parameters, `CurveIndex` of BC must be >0).<br>2: `NormalVectFile` (point normal vector file) needed<br>3: Analytical normals from surface point positions   |
  | `NormalVectFile`      | ` 	filename`     | Number of association between BC `CurveIndex` and analytical normal. Mandatory if `NormalsType=3`    |
  | `nExactNormals`      | `1`     | Number of association between BC `CurveIndex` and analytical normal. Mandatory if `NormalsType=3`    |
  | `ExactNormals`      | `(/1,1/)`     | `(/ BC curveIndex, number of analytical formula/)`. Build in formulas (see src/mesh/curved.f90):<br>1: Sphere with origin (0,0,0)<br>2: Cylinder around z-axis Mandatory if `NormalsType=3`    |
  | `boundaryOrder`      | ` 	4`     | Not used here, fixed to cubic polynomial     |

```
<h4>Output Visualization<a class="headerlink" href="#output-visualization" title="Permalink to this heading"></a></h4>

The figures below show the visualization of the boundary sphere (`BoundaryType=(/4,1,0,0/)`) of the meshes spheremesh01.cgns (<a class="reference internal" href="#fig-exmesh-01j"><span class="std std-numref">Fig. 2.4</span></a> - <a class="reference internal" href="#fig-exmesh-012"><span class="std std-numref">Fig. 2.6</span></a>), spheremesh02.cgns (<a class="reference internal" href="#fig-exmesh-02j"><span class="std std-numref">Fig. 2.8</span></a> - <a class="reference internal" href="#fig-exmesh-022"><span class="std std-numref">Fig. 2.10</span></a>) and spheremesh04.cgns (<a class="reference internal" href="#fig-exmesh-04j"><span class="std std-numref">Fig. 2.12</span></a> - <a class="reference internal" href="#fig-exmesh-042"><span class="std std-numref">Fig. 2.14</span></a>) for the three different normal vector approaches. Therefore, the SPHERE_CURVED_SplineSurf.vtu file was used. Furthermore, for the second normal vector approach (`NormalsType=2`) the point normal vector file normals_out_000001.dat was used (called filename in the captions).
For the purpose of comparison the surfaces of the original meshes the boundary sphere were assigned to are also shown (<a class="reference internal" href="#fig-exmesh-sm1"><span class="std std-numref">Fig. 2.3</span></a>, <a class="reference internal" href="#fig-exmesh-sm2"><span class="std std-numref">Fig. 2.7</span></a>, <a class="reference internal" href="#fig-exmesh-sm4"><span class="std std-numref">Fig. 2.11</span></a>) and were visualized with the SPHERE_CURVED_Debugmesh_BC.vtu file.

If there is a need for assistance of visualizing the HOPR output visit {ref}`tutorials/index_visualization:Visualization`.

<h5>spheremesh01<a class="headerlink" href="#spheremesh01" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm1">
        <a class="reference internal image-reference" href="../Exmesh-sm1.jpg"><img alt="../Exmesh-sm1.jpg" src="../Exmesh-sm1.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.3 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm1" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-01j">
        <a class="reference internal image-reference" href="../Exmesh-01j.jpg"><img alt="../Exmesh-01j.jpg" src="../Exmesh-01j.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.4 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by splines with normal vectors which are reconstructed from the coarse mesh file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 1</span></code></span><a class="headerlink" href="#fig-exmesh-01j" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-011">
        <a class="reference internal image-reference" href="../Exmesh-011.jpg"><img alt="../Exmesh-011.jpg" src="../Exmesh-011.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.5 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by normal vectors coming from a mandatory point normal vector file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 2</span></code><br><code class="docutils literal notranslate"><span class="pre">NormalVectFile = filename</span></code></span><a class="headerlink" href="#fig-exmesh-011" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-012">
        <a class="reference internal image-reference" href="../Exmesh-012.jpg"><img alt="../Exmesh-012.jpg" src="../Exmesh-012.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.6 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by analytical normals from surface point positions.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 3</span></code><br><code class="docutils literal notranslate"><span class="pre">nExactNormals = 1</span></code></span><br><code class="docutils literal notranslate"><span class="pre">ExactNormals    = (/1,1/)</span></code><a class="headerlink" href="#fig-exmesh-012" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

<h5>spheremesh02<a class="headerlink" href="#spheremesh02" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm2">
        <a class="reference internal image-reference" href="../Exmesh-sm2.jpg"><img alt="../Exmesh-sm2.jpg" src="../Exmesh-sm2.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.7 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm2" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-02j">
        <a class="reference internal image-reference" href="../Exmesh-02j.jpg"><img alt="../Exmesh-02j.jpg" src="../Exmesh-02j.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.8 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by splines with normal vectors which are reconstructed from the coarse mesh file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 1</span></code></span><a class="headerlink" href="#fig-exmesh-02j" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-021">
        <a class="reference internal image-reference" href="../Exmesh-021.jpg"><img alt="../Exmesh-021.jpg" src="../Exmesh-021.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.9 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by normal vectors coming from a mandatory point normal vector file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType      = 2</span></code><br><code class="docutils literal notranslate"><span class="pre">NormalVectFile   = filename</span></code></span><a class="headerlink" href="#fig-exmesh-021" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-022">
        <a class="reference internal image-reference" href="../Exmesh-022.jpg"><img alt="../Exmesh-022.jpg" src="../Exmesh-022.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.10 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by analytical normals from surface point positions.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 3</span></code><br><code class="docutils literal notranslate"><span class="pre">nExactNormals = 1</span></code><br><code class="docutils literal notranslate"><span class="pre">ExactNormals = (/1,1/)</span></code></span><a class="headerlink" href="#fig-exmesh-022" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

<h5>spheremesh04<a class="headerlink" href="#spheremesh04" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm4">
        <a class="reference internal image-reference" href="../Exmesh-sm4.jpg"><img alt="../Exmesh-sm4.jpg" src="../Exmesh-sm4.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.11 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm4" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-04j">
        <a class="reference internal image-reference" href="../Exmesh-04j.jpg"><img alt="../Exmesh-04j.jpg" src="../Exmesh-04j.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.12 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by splines with normal vectors which are reconstructed from the coarse mesh file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 1</span></code></span><a class="headerlink" href="#fig-exmesh-04j" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-041">
        <a class="reference internal image-reference" href="../Exmesh-041.jpg"><img alt="../Exmesh-041.jpg" src="../Exmesh-041.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.13 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by normal vectors coming from a mandatory point normal vector file.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 2</span></code><br><code class="docutils literal notranslate"><span class="pre">NormalVectFile = filename</span></code></span><a class="headerlink" href="#fig-exmesh-041" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-042">
        <a class="reference internal image-reference" href="../Exmesh-042.jpg"><img alt="../Exmesh-042.jpg" src="../Exmesh-042.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.14 </span><span class="caption-text">Boundary sphere with curved surfaces. These are generated by analytical normals from surface point positions.<br><code class="docutils literal notranslate"><span class="pre">NormalsType = 3</span></code><br><code class="docutils literal notranslate"><span class="pre">nExactNormals = 1</span></code><br><code class="docutils literal notranslate"><span class="pre">ExactNormals = (/1,1/)</span></code></span><a class="headerlink" href="#fig-exmesh-042" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

## Curving Using Subdivided Surface Mesh
Here, we need an additional surface mesh file, which contains a surface mesh (in CGNS format) generated by a mesh generator from the initial coarse surface mesh by subdivision. The additional surface points are lying on the CAD geometry and are then used as interpolation points for the polynomial description of the element face.

<h4>Description of Parameters<a class="headerlink" href="#description-of-parameters" title="Permalink to this heading"></a></h4>

Below, all parameters which are mandatory for this curving technique are explained. A description of all parameters can be found in {ref}`userguide/parameters:List of Parameters`.
```{table} Curving Using Subdivided Surface Mesh: Description of Parameters.
---
name: tab:Curving Using Subdivided Surface Mesh Description of Parameters
---
  | Parameters      |Setting                | Description |
  | :------         | :----------:          | :---------------------------     |
  | `SplitElemFile`      | `filename`     |   	Name of suvdivided surface mesh. Mandatory if `curvingMethod=3`   |
  | `boundaryOrder`      | `5`     | Order of spline-reconstruction for curved surfaces, corresponding to the number of subdivisions<br>1 x subdivided: `boundaryOrder=3`<br>2 x subdivided: `boundaryOrder=5`<br>3 x subdivided: `boundaryOrder=9`...    |
```
<h4>Output Visualization<a class="headerlink" href="#output-visualization" title="Permalink to this heading"></a></h4>

The figures below show the visualization of the SPHERE_Debugmesh_BC.vtu file by using the mesh file spheremesh01.cgns (<a class="reference internal" href="#fig-exmesh-sm1"><span class="std std-numref">Fig. 2.3</span></a> - <a class="reference internal" href="#fig-exmesh-012"><span class="std std-numref">Fig. 2.6</span></a>), spheremesh02.cgns (<a class="reference internal" href="#fig-exmesh-sm2"><span class="std std-numref">Fig. 2.7</span></a> - <a class="reference internal" href="#fig-exmesh-022"><span class="std std-numref">Fig. 2.10</span></a>) and spheremesh01.cgns (<a class="reference internal" href="#fig-exmesh-sm4"><span class="std std-numref">Fig. 2.11</span></a> -
<a class="reference internal" href="#fig-exmesh-042"><span class="std std-numref">Fig. 2.14</span></a>). In addition, for each file three examples with a different subdivision of the surface mesh are given.

If there is a need for assistance of visualizing the HOPR output visit {ref}`tutorials/index_visualization:Visualization`.

<h5>spheremesh01<a class="headerlink" href="#spheremesh01" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm1">
        <a class="reference internal image-reference" href="../Exmesh-sm1.jpg"><img alt="../Exmesh-sm1.jpg" src="../Exmesh-sm1.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.15 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm1" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm14">
        <a class="reference internal image-reference" href="../Exmesh-sm14.jpg"><img alt="../Exmesh-sm14.jpg" src="../Exmesh-sm14.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.15 </span><span class="caption-text">Boundary sphere with a double subdivision of the surface mesh by using the sphere_surfmesh_04.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 5</span></code></span><a class="headerlink" href="#fig-exmesh-sm14" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm16">
        <a class="reference internal image-reference" href="../Exmesh-sm16.jpg"><img alt="../Exmesh-sm16.jpg" src="../Exmesh-sm16.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.16 </span><span class="caption-text">Boundary sphere by using the sphere_surfmesh_06.cgns file. Because of the fact that this subdivision pattern was created neither with a double nor with a triple subdivision of the surface mesh the parameter <code class="docutils literal notranslate"><span class="pre">boundaryOrder</span></code> has to be adapted accordingly.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 7</span></code></span><a class="headerlink" href="#fig-exmesh-sm16" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm18">
        <a class="reference internal image-reference" href="../Exmesh-sm18.jpg"><img alt="../Exmesh-sm18.jpg" src="../Exmesh-sm18.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.17 </span><span class="caption-text">Boundary sphere with a triple subdivision of the surface mesh by using the sphere_surfmesh_08.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 9</span></code></span><a class="headerlink" href="#fig-exmesh-sm18" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

<h5>spheremesh02<a class="headerlink" href="#spheremesh01" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm2">
        <a class="reference internal image-reference" href="../Exmesh-sm2.jpg"><img alt="../Exmesh-sm2.jpg" src="../Exmesh-sm2.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.18 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm2" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm28">
        <a class="reference internal image-reference" href="../Exmesh-sm28.jpg"><img alt="../Exmesh-sm28.jpg" src="../Exmesh-sm28.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.19 </span><span class="caption-text">Boundary sphere with a double subdivision of the surface mesh by using the sphere_surfmesh_08.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 5</span></code></span><a class="headerlink" href="#fig-exmesh-sm28" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm210">
        <a class="reference internal image-reference" href="../Exmesh-sm210.jpg"><img alt="../Exmesh-sm210.jpg" src="../Exmesh-sm210.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.20 </span><span class="caption-text">Boundary sphere by using the sphere_surfmesh_10.cgns file. Because of the fact that this subdivision pattern was created neither with a double nor with a triple subdivision of the surface mesh the parameter <code class="docutils literal notranslate"><span class="pre">boundaryOrder</span></code> has to be adapted accordingly.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 6</span></code></span><a class="headerlink" href="#fig-exmesh-sm210" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm216">
        <a class="reference internal image-reference" href="../Exmesh-sm216.jpg"><img alt="../Exmesh-sm216.jpg" src="../Exmesh-sm216.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.21 </span><span class="caption-text">Boundary sphere with a triple subdivision of the surface mesh by using the sphere_surfmesh_16.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 9</span></code></span><a class="headerlink" href="#fig-exmesh-sm216" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

<h5>spheremesh04<a class="headerlink" href="#spheremesh01" title="Permalink to this heading"></a></h5>

<table align="center" style="width:100%">
  <tr>
    <td style="width:25%">
        <figure id="fig-exmesh-sm4">
        <a class="reference internal image-reference" href="../Exmesh-sm4.jpg"><img alt="../Exmesh-sm4.jpg" src="../Exmesh-sm4.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.22 </span><span class="caption-text">Boundary sphere without using a curving technique. </span><a class="headerlink" href="#fig-exmesh-sm4" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm48">
        <a class="reference internal image-reference" href="../Exmesh-sm48.jpg"><img alt="../Exmesh-sm48.jpg" src="../Exmesh-sm48.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.23 </span><span class="caption-text">Boundary sphere with a single subdivision of the surface mesh by using the sphere_surfmesh_08.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 3</span></code></span><a class="headerlink" href="#fig-exmesh-sm48" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm416">
        <a class="reference internal image-reference" href="../Exmesh-sm416.jpg"><img alt="../Exmesh-sm416.jpg" src="../Exmesh-sm416.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.24 </span><span class="caption-text">Boundary sphere with a double subdivision of the surface mesh by using the sphere_surfmesh_16.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 5</span></code></span><a class="headerlink" href="#fig-exmesh-sm416" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
    <td style="width:25%">
        <figure id="fig-exmesh-sm436">
        <a class="reference internal image-reference" href="../Exmesh-sm436.jpg"><img alt="../Exmesh-sm436.jpg" src="../Exmesh-sm436.jpg" style="height:200px;" /></a>
        <figcaption>
        <p><span class="caption-number">Fig. 2.25 </span><span class="caption-text">Boundary sphere with a triple subdivision of the surface mesh by using the sphere_surfmesh_36.cgns file.<br><code class="docutils literal notranslate"><span class="pre">boundaryOrder = 9</span></code></span><a class="headerlink" href="#fig-exmesh-sm436" title="Permalink to this image"></a></p>
        </figcaption>
        </figure>
    </td>
  </tr>
</table>

## Use of pre-curved meshes
In some situations, the input mesh is already curved, e.g. when HOPRs own meshes are used for input or if the mesh generator already provides curved meshes (e.g. Gmsh). HOPR will read these meshes and directly use their high-order information. Existing high-order meshes from other sources can thus be directly translated into the HOPR format. Furthermore, HOPR's various mesh post-processing capabilities can be applied to these meshes and the mesh curving can optionally also be redone by using the normal vector and the subdivision approach described above.

<h4>Description of Parameters<a class="headerlink" href="#description-of-parameters" title="Permalink to this heading"></a></h4>

Below, the mandatory parameters for reading a Gmsh mesh file are described. Note that in case of Gmsh meshes HOPR currently only supports linear pyramids and prisms, while tetrahedra and hexahedra are supported up to an order of 4. A description of all parameters can be found in {ref}`userguide/parameters:List of Parameters`.

```{table} Use of pre-curved meshes: Description of Parameters.
---
name: tab:Use of pre-curved meshes Description of Parameters
---
  | Parameters      |Setting                | Description |
  | :------         | :----------:          | :---------------------------     |
  | `Filename`      | `cylinder.msh`     | Name of mesh file.   |
  | `boundaryOrder`      | `4`     | Order of the geometry approximation in the mesh, i.e. the number of interpolation points per direction. Note: Gmsh denotes the polynomial degree by the term "order".    |
```

<h4>Output Visualization<a class="headerlink" href="#output-visualization" title="Permalink to this heading"></a></h4>

The figure below shows the visualization of the CYLINDER_SplineVol.dat file by using the mesh file cylinder.msh.

<h5>cylinder<a class="headerlink" href="#cylinder" title="Permalink to this heading"></a></h5>

<figure class="align-center" id="fig-cylinder-gmsh">
    <a class="reference internal image-reference" href="../Cylinder_gmsh.png"><img alt="../Cylinder_gmsh.png" src="../Cylinder_gmsh.png" style="width: 30%;" /></a>
    <figcaption>
    <p><span class="caption-number">Fig. 2.26 </span><span class="caption-text">Curved mesh file created by Gmsh..</span><a class="headerlink" href="#fig-cylinder-gmsh" title="Permalink to this image"></a></p>
    </figcaption>
</figure>
